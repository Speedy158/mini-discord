<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Mini Discord Chat</title>
    <style>
      body { font-family: Arial; background: #f5f5f5; margin: 0; padding: 20px; }
      h1 { margin-top: 0; }
      #messages { 
        border: 1px solid #ccc; 
        height: 300px; 
        overflow-y: scroll; 
        padding: 10px; 
        background: white;
      }
      #input { 
        width: 80%; 
        padding: 10px; 
        margin-top: 10px;
      }
      #send { 
        padding: 10px; 
        margin-left: 5px;
      }
      .msg-name {
        font-weight: bold;
        margin-right: 5px;
      }
      .msg-line {
        margin-bottom: 5px;
      }
    </style>
  </head>
  <body>
    <h1>Mini Discord â€“ Live Chat</h1>

    <div id="messages"></div>

    <input id="input" placeholder="Nachricht eingeben..." autocomplete="off">
    <button id="send">Senden</button>

    <!-- Socket.io laden -->
    <script src="/socket.io/socket.io.js"></script>

    <script>
      const socket = io();

      let username = "";

      // Benutzername abfragen
      while (!username || username.trim() === "") {
        username = prompt("Bitte gib deinen Namen ein:");
      }

      const messages = document.getElementById('messages');
      const input = document.getElementById('input');
      const send = document.getElementById('send');

      function sendMessage() {
        const text = input.value;
        if (text.trim() !== "") {
          socket.emit('chatMessage', { name: username, text: text });
          input.value = "";
        }
      }

      send.onclick = sendMessage;

      input.addEventListener('keydown', (event) => {
        if (event.key === "Enter") {
          sendMessage();
        }
      });

      socket.on('chatMessage', (msg) => {
        const line = document.createElement('div');
        line.classList.add("msg-line");

        const nameSpan = document.createElement('span');
        nameSpan.classList.add("msg-name");
        nameSpan.textContent = msg.name + ":";

        const textSpan = document.createElement('span');
        textSpan.textContent = msg.text;

        line.appendChild(nameSpan);
        line.appendChild(textSpan);

        messages.appendChild(line);
        messages.scrollTop = messages.scrollHeight;
      });
    </script>
  </body>
</html>

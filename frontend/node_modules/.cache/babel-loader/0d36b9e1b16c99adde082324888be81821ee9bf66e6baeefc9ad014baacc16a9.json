{"ast":null,"code":"import _objectSpread from\"C:/Users/ericb/mini-discord/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import{socket}from\"../socket\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserList(){const username=localStorage.getItem(\"username\");const[voiceChannels,setVoiceChannels]=useState({});const[users,setUsers]=useState({});const[speakingUsers,setSpeakingUsers]=useState({});const[myVoiceChannel,setMyVoiceChannel]=useState(null);useEffect(()=>{const handleVoiceUpdate=channels=>{setVoiceChannels(channels);// herausfinden, in welchem Channel ich bin\nlet found=null;Object.entries(channels).forEach(_ref=>{let[ch,list]=_ref;if(list.some(u=>u.username===username)){found=ch;}});setMyVoiceChannel(found);};socket.on(\"voiceChannelUpdate\",handleVoiceUpdate);socket.on(\"avatarUpdate\",setUsers);socket.on(\"speakingStart\",_ref2=>{let{user}=_ref2;return setSpeakingUsers(p=>_objectSpread(_objectSpread({},p),{},{[user]:true}));});socket.on(\"speakingStop\",_ref3=>{let{user}=_ref3;return setSpeakingUsers(p=>_objectSpread(_objectSpread({},p),{},{[user]:false}));});return()=>{socket.off(\"voiceChannelUpdate\",handleVoiceUpdate);socket.off(\"avatarUpdate\",setUsers);socket.off(\"speakingStart\");socket.off(\"speakingStop\");};},[username]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{opacity:0.6,marginBottom:10},children:\"VOICE USERS\"}),Object.keys(voiceChannels).map(channel=>{var _username$;const isMyChannel=channel===myVoiceChannel;const av=users[username]||{avatarType:\"default\",avatarColor:\"#5865F2\",avatarLetter:(username===null||username===void 0?void 0:(_username$=username[0])===null||_username$===void 0?void 0:_username$.toUpperCase())||\"?\",avatarImage:null};const isSpeaking=speakingUsers[username];return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:15},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:12,opacity:0.7,marginBottom:4},children:channel}),isMyChannel&&/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",marginBottom:4},children:[/*#__PURE__*/_jsx(\"div\",{className:isSpeaking?\"speaking-ring\":undefined,style:{width:28,height:28,borderRadius:\"50%\",overflow:\"hidden\",marginRight:8,background:av.avatarType===\"default\"?av.avatarColor:\"transparent\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontWeight:\"bold\",fontSize:14},children:av.avatarType===\"image\"?/*#__PURE__*/_jsx(\"img\",{src:av.avatarImage,className:\"avatar\",alt:\"\"}):av.avatarLetter}),/*#__PURE__*/_jsx(\"div\",{children:username})]})]},channel);})]});}","map":{"version":3,"names":["React","useEffect","useState","socket","jsx","_jsx","jsxs","_jsxs","UserList","username","localStorage","getItem","voiceChannels","setVoiceChannels","users","setUsers","speakingUsers","setSpeakingUsers","myVoiceChannel","setMyVoiceChannel","handleVoiceUpdate","channels","found","Object","entries","forEach","_ref","ch","list","some","u","on","_ref2","user","p","_objectSpread","_ref3","off","children","style","opacity","marginBottom","keys","map","channel","_username$","isMyChannel","av","avatarType","avatarColor","avatarLetter","toUpperCase","avatarImage","isSpeaking","fontSize","display","alignItems","className","undefined","width","height","borderRadius","overflow","marginRight","background","justifyContent","fontWeight","src","alt"],"sources":["C:/Users/ericb/mini-discord/frontend/src/components/UserList.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { socket } from \"../socket\";\r\n\r\nexport default function UserList() {\r\n  const username = localStorage.getItem(\"username\");\r\n\r\n  const [voiceChannels, setVoiceChannels] = useState({});\r\n  const [users, setUsers] = useState({});\r\n  const [speakingUsers, setSpeakingUsers] = useState({});\r\n  const [myVoiceChannel, setMyVoiceChannel] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const handleVoiceUpdate = (channels) => {\r\n      setVoiceChannels(channels);\r\n\r\n      // herausfinden, in welchem Channel ich bin\r\n      let found = null;\r\n      Object.entries(channels).forEach(([ch, list]) => {\r\n        if (list.some((u) => u.username === username)) {\r\n          found = ch;\r\n        }\r\n      });\r\n      setMyVoiceChannel(found);\r\n    };\r\n\r\n    socket.on(\"voiceChannelUpdate\", handleVoiceUpdate);\r\n    socket.on(\"avatarUpdate\", setUsers);\r\n\r\n    socket.on(\"speakingStart\", ({ user }) =>\r\n      setSpeakingUsers((p) => ({ ...p, [user]: true }))\r\n    );\r\n\r\n    socket.on(\"speakingStop\", ({ user }) =>\r\n      setSpeakingUsers((p) => ({ ...p, [user]: false }))\r\n    );\r\n\r\n    return () => {\r\n      socket.off(\"voiceChannelUpdate\", handleVoiceUpdate);\r\n      socket.off(\"avatarUpdate\", setUsers);\r\n      socket.off(\"speakingStart\");\r\n      socket.off(\"speakingStop\");\r\n    };\r\n  }, [username]);\r\n\r\n  return (\r\n    <div>\r\n      <div style={{ opacity: 0.6, marginBottom: 10 }}>VOICE USERS</div>\r\n\r\n      {Object.keys(voiceChannels).map((channel) => {\r\n        const isMyChannel = channel === myVoiceChannel;\r\n        const av = users[username] || {\r\n          avatarType: \"default\",\r\n          avatarColor: \"#5865F2\",\r\n          avatarLetter: username?.[0]?.toUpperCase() || \"?\",\r\n          avatarImage: null\r\n        };\r\n        const isSpeaking = speakingUsers[username];\r\n\r\n        return (\r\n          <div key={channel} style={{ marginBottom: 15 }}>\r\n            <div style={{ fontSize: 12, opacity: 0.7, marginBottom: 4 }}>\r\n              {channel}\r\n            </div>\r\n\r\n            {isMyChannel && (\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  alignItems: \"center\",\r\n                  marginBottom: 4\r\n                }}\r\n              >\r\n                <div\r\n                  className={isSpeaking ? \"speaking-ring\" : undefined}\r\n                  style={{\r\n                    width: 28,\r\n                    height: 28,\r\n                    borderRadius: \"50%\",\r\n                    overflow: \"hidden\",\r\n                    marginRight: 8,\r\n                    background:\r\n                      av.avatarType === \"default\"\r\n                        ? av.avatarColor\r\n                        : \"transparent\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    fontWeight: \"bold\",\r\n                    fontSize: 14\r\n                  }}\r\n                >\r\n                  {av.avatarType === \"image\" ? (\r\n                    <img src={av.avatarImage} className=\"avatar\" alt=\"\" />\r\n                  ) : (\r\n                    av.avatarLetter\r\n                  )}\r\n                </div>\r\n\r\n                <div>{username}</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"yHAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,MAAM,KAAQ,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnC,cAAe,SAAS,CAAAC,QAAQA,CAAA,CAAG,CACjC,KAAM,CAAAC,QAAQ,CAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CAEjD,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAGX,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtD,KAAM,CAACY,KAAK,CAAEC,QAAQ,CAAC,CAAGb,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtC,KAAM,CAACc,aAAa,CAAEC,gBAAgB,CAAC,CAAGf,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtD,KAAM,CAACgB,cAAc,CAAEC,iBAAiB,CAAC,CAAGjB,QAAQ,CAAC,IAAI,CAAC,CAE1DD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAmB,iBAAiB,CAAIC,QAAQ,EAAK,CACtCR,gBAAgB,CAACQ,QAAQ,CAAC,CAE1B;AACA,GAAI,CAAAC,KAAK,CAAG,IAAI,CAChBC,MAAM,CAACC,OAAO,CAACH,QAAQ,CAAC,CAACI,OAAO,CAACC,IAAA,EAAgB,IAAf,CAACC,EAAE,CAAEC,IAAI,CAAC,CAAAF,IAAA,CAC1C,GAAIE,IAAI,CAACC,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACrB,QAAQ,GAAKA,QAAQ,CAAC,CAAE,CAC7Ca,KAAK,CAAGK,EAAE,CACZ,CACF,CAAC,CAAC,CACFR,iBAAiB,CAACG,KAAK,CAAC,CAC1B,CAAC,CAEDnB,MAAM,CAAC4B,EAAE,CAAC,oBAAoB,CAAEX,iBAAiB,CAAC,CAClDjB,MAAM,CAAC4B,EAAE,CAAC,cAAc,CAAEhB,QAAQ,CAAC,CAEnCZ,MAAM,CAAC4B,EAAE,CAAC,eAAe,CAAEC,KAAA,MAAC,CAAEC,IAAK,CAAC,CAAAD,KAAA,OAClC,CAAAf,gBAAgB,CAAEiB,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAWD,CAAC,MAAE,CAACD,IAAI,EAAG,IAAI,EAAG,CAAC,EACnD,CAAC,CAED9B,MAAM,CAAC4B,EAAE,CAAC,cAAc,CAAEK,KAAA,MAAC,CAAEH,IAAK,CAAC,CAAAG,KAAA,OACjC,CAAAnB,gBAAgB,CAAEiB,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAWD,CAAC,MAAE,CAACD,IAAI,EAAG,KAAK,EAAG,CAAC,EACpD,CAAC,CAED,MAAO,IAAM,CACX9B,MAAM,CAACkC,GAAG,CAAC,oBAAoB,CAAEjB,iBAAiB,CAAC,CACnDjB,MAAM,CAACkC,GAAG,CAAC,cAAc,CAAEtB,QAAQ,CAAC,CACpCZ,MAAM,CAACkC,GAAG,CAAC,eAAe,CAAC,CAC3BlC,MAAM,CAACkC,GAAG,CAAC,cAAc,CAAC,CAC5B,CAAC,CACH,CAAC,CAAE,CAAC5B,QAAQ,CAAC,CAAC,CAEd,mBACEF,KAAA,QAAA+B,QAAA,eACEjC,IAAA,QAAKkC,KAAK,CAAE,CAAEC,OAAO,CAAE,GAAG,CAAEC,YAAY,CAAE,EAAG,CAAE,CAAAH,QAAA,CAAC,aAAW,CAAK,CAAC,CAEhEf,MAAM,CAACmB,IAAI,CAAC9B,aAAa,CAAC,CAAC+B,GAAG,CAAEC,OAAO,EAAK,KAAAC,UAAA,CAC3C,KAAM,CAAAC,WAAW,CAAGF,OAAO,GAAK1B,cAAc,CAC9C,KAAM,CAAA6B,EAAE,CAAGjC,KAAK,CAACL,QAAQ,CAAC,EAAI,CAC5BuC,UAAU,CAAE,SAAS,CACrBC,WAAW,CAAE,SAAS,CACtBC,YAAY,CAAE,CAAAzC,QAAQ,SAARA,QAAQ,kBAAAoC,UAAA,CAARpC,QAAQ,CAAG,CAAC,CAAC,UAAAoC,UAAA,iBAAbA,UAAA,CAAeM,WAAW,CAAC,CAAC,GAAI,GAAG,CACjDC,WAAW,CAAE,IACf,CAAC,CACD,KAAM,CAAAC,UAAU,CAAGrC,aAAa,CAACP,QAAQ,CAAC,CAE1C,mBACEF,KAAA,QAAmBgC,KAAK,CAAE,CAAEE,YAAY,CAAE,EAAG,CAAE,CAAAH,QAAA,eAC7CjC,IAAA,QAAKkC,KAAK,CAAE,CAAEe,QAAQ,CAAE,EAAE,CAAEd,OAAO,CAAE,GAAG,CAAEC,YAAY,CAAE,CAAE,CAAE,CAAAH,QAAA,CACzDM,OAAO,CACL,CAAC,CAELE,WAAW,eACVvC,KAAA,QACEgC,KAAK,CAAE,CACLgB,OAAO,CAAE,MAAM,CACfC,UAAU,CAAE,QAAQ,CACpBf,YAAY,CAAE,CAChB,CAAE,CAAAH,QAAA,eAEFjC,IAAA,QACEoD,SAAS,CAAEJ,UAAU,CAAG,eAAe,CAAGK,SAAU,CACpDnB,KAAK,CAAE,CACLoB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVC,YAAY,CAAE,KAAK,CACnBC,QAAQ,CAAE,QAAQ,CAClBC,WAAW,CAAE,CAAC,CACdC,UAAU,CACRjB,EAAE,CAACC,UAAU,GAAK,SAAS,CACvBD,EAAE,CAACE,WAAW,CACd,aAAa,CACnBM,OAAO,CAAE,MAAM,CACfC,UAAU,CAAE,QAAQ,CACpBS,cAAc,CAAE,QAAQ,CACxBC,UAAU,CAAE,MAAM,CAClBZ,QAAQ,CAAE,EACZ,CAAE,CAAAhB,QAAA,CAEDS,EAAE,CAACC,UAAU,GAAK,OAAO,cACxB3C,IAAA,QAAK8D,GAAG,CAAEpB,EAAE,CAACK,WAAY,CAACK,SAAS,CAAC,QAAQ,CAACW,GAAG,CAAC,EAAE,CAAE,CAAC,CAEtDrB,EAAE,CAACG,YACJ,CACE,CAAC,cAEN7C,IAAA,QAAAiC,QAAA,CAAM7B,QAAQ,CAAM,CAAC,EAClB,CACN,GAzCOmC,OA0CL,CAAC,CAEV,CAAC,CAAC,EACC,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"// src/pages/ChatPage.jsx\nimport React,{useEffect,useState}from\"react\";import ChannelList from\"../components/ChannelList\";import ChatWindow from\"../components/ChatWindow\";import VoicePanel from\"../components/VoicePanel\";import UserList from\"../components/UserList\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE=\"http://localhost:3000\";function ChatPage(){const[session,setSession]=useState(null);const[username,setUsername]=useState(null);const[currentChannel,setCurrentChannel]=useState(null);// Session prüfen\nuseEffect(()=>{const sessionId=localStorage.getItem(\"sessionId\");if(!sessionId)return;fetch(\"\".concat(API_BASE,\"/api/users/me\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\",\"x-session-id\":sessionId},body:JSON.stringify({})}).then(res=>res.json()).then(data=>{if(data.ok){setSession(sessionId);setUsername(data.user.username);}else{localStorage.removeItem(\"sessionId\");}});},[]);if(!session){return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Keine Session gefunden\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Bitte neu einloggen.\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Zur\\xFCck zum Login\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-layout\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-left\",children:[/*#__PURE__*/_jsx(ChannelList,{currentChannel:currentChannel,onSelectChannel:setCurrentChannel}),/*#__PURE__*/_jsx(VoicePanel,{username:username})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-main\",children:/*#__PURE__*/_jsx(ChatWindow,{currentChannel:currentChannel,username:username})}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-right\",children:/*#__PURE__*/_jsx(UserList,{})})]});}export default ChatPage;","map":{"version":3,"names":["React","useEffect","useState","ChannelList","ChatWindow","VoicePanel","UserList","jsx","_jsx","jsxs","_jsxs","API_BASE","ChatPage","session","setSession","username","setUsername","currentChannel","setCurrentChannel","sessionId","localStorage","getItem","fetch","concat","method","headers","body","JSON","stringify","then","res","json","data","ok","user","removeItem","style","padding","children","href","className","onSelectChannel"],"sources":["C:/Users/ericb/mini-discord/frontend/src/pages/ChatPage.jsx"],"sourcesContent":["// src/pages/ChatPage.jsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport ChannelList from \"../components/ChannelList\";\r\nimport ChatWindow from \"../components/ChatWindow\";\r\nimport VoicePanel from \"../components/VoicePanel\";\r\nimport UserList from \"../components/UserList\";\r\n\r\nconst API_BASE = \"http://localhost:3000\";\r\n\r\nfunction ChatPage() {\r\n  const [session, setSession] = useState(null);\r\n  const [username, setUsername] = useState(null);\r\n  const [currentChannel, setCurrentChannel] = useState(null);\r\n\r\n  // Session prüfen\r\n  useEffect(() => {\r\n    const sessionId = localStorage.getItem(\"sessionId\");\r\n    if (!sessionId) return;\r\n\r\n    fetch(`${API_BASE}/api/users/me`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"x-session-id\": sessionId\r\n      },\r\n      body: JSON.stringify({})\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        if (data.ok) {\r\n          setSession(sessionId);\r\n          setUsername(data.user.username);\r\n        } else {\r\n          localStorage.removeItem(\"sessionId\");\r\n        }\r\n      });\r\n  }, []);\r\n\r\n  if (!session) {\r\n    return (\r\n      <div style={{ padding: 20 }}>\r\n        <h2>Keine Session gefunden</h2>\r\n        <p>Bitte neu einloggen.</p>\r\n        <a href=\"/\">Zurück zum Login</a>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"chat-layout\">\r\n      <div className=\"sidebar-left\">\r\n        <ChannelList\r\n          currentChannel={currentChannel}\r\n          onSelectChannel={setCurrentChannel}\r\n        />\r\n        <VoicePanel username={username} />\r\n      </div>\r\n\r\n      <div className=\"chat-main\">\r\n        <ChatWindow currentChannel={currentChannel} username={username} />\r\n      </div>\r\n\r\n      <div className=\"sidebar-right\">\r\n        <UserList />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatPage;\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,WAAW,KAAM,2BAA2B,CACnD,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CACjD,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CACjD,MAAO,CAAAC,QAAQ,KAAM,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE9C,KAAM,CAAAC,QAAQ,CAAG,uBAAuB,CAExC,QAAS,CAAAC,QAAQA,CAAA,CAAG,CAClB,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACa,QAAQ,CAAEC,WAAW,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAC9C,KAAM,CAACe,cAAc,CAAEC,iBAAiB,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAE1D;AACAD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAkB,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CACnD,GAAI,CAACF,SAAS,CAAE,OAEhBG,KAAK,IAAAC,MAAA,CAAIZ,QAAQ,kBAAiB,CAChCa,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,cAAc,CAAEN,SAClB,CAAC,CACDO,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAC,CAAC,CACzB,CAAC,CAAC,CACCC,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEG,IAAI,EAAK,CACd,GAAIA,IAAI,CAACC,EAAE,CAAE,CACXnB,UAAU,CAACK,SAAS,CAAC,CACrBH,WAAW,CAACgB,IAAI,CAACE,IAAI,CAACnB,QAAQ,CAAC,CACjC,CAAC,IAAM,CACLK,YAAY,CAACe,UAAU,CAAC,WAAW,CAAC,CACtC,CACF,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN,GAAI,CAACtB,OAAO,CAAE,CACZ,mBACEH,KAAA,QAAK0B,KAAK,CAAE,CAAEC,OAAO,CAAE,EAAG,CAAE,CAAAC,QAAA,eAC1B9B,IAAA,OAAA8B,QAAA,CAAI,wBAAsB,CAAI,CAAC,cAC/B9B,IAAA,MAAA8B,QAAA,CAAG,sBAAoB,CAAG,CAAC,cAC3B9B,IAAA,MAAG+B,IAAI,CAAC,GAAG,CAAAD,QAAA,CAAC,qBAAgB,CAAG,CAAC,EAC7B,CAAC,CAEV,CAEA,mBACE5B,KAAA,QAAK8B,SAAS,CAAC,aAAa,CAAAF,QAAA,eAC1B5B,KAAA,QAAK8B,SAAS,CAAC,cAAc,CAAAF,QAAA,eAC3B9B,IAAA,CAACL,WAAW,EACVc,cAAc,CAAEA,cAAe,CAC/BwB,eAAe,CAAEvB,iBAAkB,CACpC,CAAC,cACFV,IAAA,CAACH,UAAU,EAACU,QAAQ,CAAEA,QAAS,CAAE,CAAC,EAC/B,CAAC,cAENP,IAAA,QAAKgC,SAAS,CAAC,WAAW,CAAAF,QAAA,cACxB9B,IAAA,CAACJ,UAAU,EAACa,cAAc,CAAEA,cAAe,CAACF,QAAQ,CAAEA,QAAS,CAAE,CAAC,CAC/D,CAAC,cAENP,IAAA,QAAKgC,SAAS,CAAC,eAAe,CAAAF,QAAA,cAC5B9B,IAAA,CAACF,QAAQ,GAAE,CAAC,CACT,CAAC,EACH,CAAC,CAEV,CAEA,cAAe,CAAAM,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}